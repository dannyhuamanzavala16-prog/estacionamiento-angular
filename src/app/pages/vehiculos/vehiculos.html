<app-admin-header></app-admin-header>
<!-- ===== CONTENIDO PRINCIPAL ===== -->
<main>

  <!-- ESTADO EN TIEMPO REAL -->
  <section class="parking-status">
    <div class="status-header">
      <h2>üÖøÔ∏è Estado del Estacionamiento en Tiempo Real</h2>
      <div class="status-indicators">
        <div class="indicator disponibles">
          üü¢ <span>{{ espaciosLibres }}</span> Libres
        </div>
        <div class="indicator ocupados">
          üî¥ <span>{{ espaciosOcupados }}</span> Ocupados
        </div>
        <div class="indicator total">
          üìä <span>{{ espaciosTotal }}</span> Total
        </div>
        <button class="btn-refresh" (click)="actualizarEstadisticas()">üîÑ Actualizar</button>
      </div>
    </div>
    
    <div class="spaces-grid">
      <!-- Fila 1: E-01 a E-14 -->
      <div class="space-card ocupado">
        <div class="space-number">E-01</div>
        <div class="space-label">OCUPADO</div>
        <div class="space-placa">ACA-722</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-02</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-03</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-04</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-05</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-06</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-07</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-08</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-09</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-10</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-11</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-12</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-13</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-14</div>
        <div class="space-label">LIBRE</div>
      </div>
      
      <!-- Fila 2: E-15 a E-20 -->
      <div class="space-card libre">
        <div class="space-number">E-15</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-16</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-17</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-18</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-19</div>
        <div class="space-label">LIBRE</div>
      </div>
      <div class="space-card libre">
        <div class="space-number">E-20</div>
        <div class="space-label">LIBRE</div>
      </div>
    </div>
  </section>

  <div class="dashboard-grid">

    <!-- FORMULARIO DE REGISTRO -->
    <section class="registro">
      <h2>üìã Registrar Entrada de Veh√≠culo</h2>
      
      <form (submit)="registrarVehiculo($event)">
        <div class="form-group">
          <label for="placa">Placa del Veh√≠culo *</label>
          <input type="text" id="placa" placeholder="ABC-123" required>
        </div>
        
        <div class="form-group">
          <label for="propietario">Propietario *</label>
          <input type="text" id="propietario" placeholder="Juan P√©rez" required>
        </div>
        
        <div class="form-group">
          <label for="tipo">Tipo de Veh√≠culo *</label>
          <select id="tipo" required>
            <option value="">Seleccionar tipo</option>
            <option value="Auto">Auto üöó</option>
            <option value="Moto">Moto üèçÔ∏è</option>
            <option value="Camioneta">Camioneta üöô</option>
            <option value="SUV">SUV üöê</option>
          </select>
        </div>
        
        <button type="submit">‚úì Registrar Entrada</button>
      </form>
      
      <div id="mensaje" class="mensaje" style="display: none;"></div>
    </section>
    
    <!-- TABLA DE VEH√çCULOS -->
    <section class="tabla">
      <h2>üöó Veh√≠culos Registrados</h2>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>ESPACIO</th>
              <th>PLACA</th>
              <th>PROPIETARIO</th>
              <th>TIPO</th>
              <th>HORA ENTRADA</th>
              <th>HORA SALIDA</th>
              <th>DURACI√ìN</th>
              <th>ESTADO</th>
              <th>ACCI√ìN</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="vehiculos.length === 0">
              <td colspan="9" style="text-align:center; padding: 2rem; color: #64748b;">
                No hay veh√≠culos registrados actualmente.
              </td>
            </tr>
            <tr *ngFor="let vehiculo of vehiculos">
              <td>
                <div class="espacio-col">E-{{ vehiculo.espacio < 10 ? '0' + vehiculo.espacio : vehiculo.espacio }}</div>
                <div class="espacio-num">Col {{ vehiculo.columna }}</div>
              </td>
              <td><span class="placa-badge">{{ vehiculo.placa }}</span></td>
              <td>{{ vehiculo.propietario }}</td>
              <td>{{ vehiculo.tipo }}</td>
              <td>{{ formatearFecha(vehiculo.horaEntrada) }}</td>
              <td>{{ vehiculo.horaSalida ? formatearFecha(vehiculo.horaSalida) : '-' }}</td>
              <td>{{ vehiculo.duracion || '-' }}</td>
              <td>
                <span [class]="vehiculo.estado === 'activo' ? 'badge-activo' : 'badge-finalizado'">
                  {{ vehiculo.estado === 'activo' ? 'ACTIVO' : 'FINALIZADO' }}
                </span>
              </td>
              <td>
                <button 
                  *ngIf="vehiculo.estado === 'activo'" 
                  (click)="finalizarVehiculo(vehiculo)"
                  class="btn-salida">
                  üöÄ Registrar Salida
                </button>
                <span *ngIf="vehiculo.estado === 'finalizado'" style="color: #64748b; font-size: 0.875rem;">‚úì Completado</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>

  <!-- ESTAD√çSTICAS R√ÅPIDAS -->
  <section class="quick-stats">
    <h2>üìä Estad√≠sticas de Hoy</h2>
    
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-label">Veh√≠culos Hoy</div>
        <div class="stat-value">{{ vehiculosHoy }}</div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Activos Ahora</div>
        <div class="stat-value">{{ vehiculosActivos }}</div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Tiempo Promedio</div>
        <div class="stat-value">{{ tiempoPromedio }}</div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Ocupaci√≥n</div>
        <div class="stat-value">{{ porcentajeOcupacion }}%</div>
      </div>
    </div>
  </section>

</main>

<!-- FOOTER COMPARTIDO -->
<app-footer></app-footer>