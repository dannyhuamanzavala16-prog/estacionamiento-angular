<!-- HEADER COMPARTIDO GUARDIA -->
<app-guardia-header></app-guardia-header>

<main>
  
  <!-- ESTADO DE CARGA -->
  <div *ngIf="cargando" class="loading">
    <div class="loading-spinner"></div>
    <p>Buscando vehÃ­culo...</p>
  </div>

  <!-- ERROR -->
  <div *ngIf="error && !cargando" class="error">
    <p>âš ï¸ {{ error }}</p>
    <button class="btn-filter" (click)="limpiarBusqueda()">ğŸ”„ Limpiar</button>
  </div>

  <!-- CONTENIDO PRINCIPAL -->
  <ng-container *ngIf="!cargando && !error">
    <!-- ENCABEZADO -->
    <div class="header-section">
      <h2>ğŸ” Buscar VehÃ­culo por Placa</h2>
      <p class="subtitle">
        Ingresa la placa del vehÃ­culo para ver su informaciÃ³n actual y verificar si estÃ¡ en el estacionamiento.
      </p>
    </div>

    <!-- FORMULARIO DE BÃšSQUEDA -->
    <div class="search-section">
      <div class="search-container">
        <div class="search-input-group">
          <label for="searchPlaca">ğŸš— Placa del VehÃ­culo</label>
          <input 
            type="text" 
            id="searchPlaca" 
            placeholder="Ej: ABC-123"
            [(ngModel)]="placaBusqueda"
            (keyup.enter)="buscarVehiculo()"
            maxlength="10">
        </div>
        <button class="btn-search" (click)="buscarVehiculo()" [disabled]="!placaBusqueda.trim()">
          ğŸ” Buscar
        </button>
      </div>
    </div>

    <!-- RESULTADO DE BÃšSQUEDA -->
    <div *ngIf="vehiculoEncontrado" class="result-section">
      <div class="result-card success">
        <div class="result-header">
          <span class="result-icon">âœ…</span>
          <h3>VehÃ­culo Encontrado</h3>
        </div>
        
        <div class="result-body">
          <div class="result-row">
            <span class="result-label">ğŸ…¿ï¸ Espacio:</span>
            <span class="result-value highlight">E-{{ vehiculoEncontrado!.espacioNumero! < 10 ? '0' + vehiculoEncontrado!.espacioNumero : vehiculoEncontrado!.espacioNumero }}</span>
          </div>
          
          <div class="result-row">
            <span class="result-label">ğŸš— Placa:</span>
            <span class="result-value placa-badge">{{ vehiculoEncontrado!.placa }}</span>
          </div>
          
          <div class="result-row">
            <span class="result-label">ğŸ‘¤ Propietario:</span>
            <span class="result-value">{{ vehiculoEncontrado!.propietario }}</span>
          </div>
          
          <div class="result-row">
            <span class="result-label">ğŸš™ Tipo:</span>
            <span class="result-value">{{ vehiculoEncontrado!.tipo }}</span>
          </div>
          
          <div class="result-row">
            <span class="result-label">ğŸ• Hora Entrada:</span>
            <span class="result-value">{{ formatearFecha(vehiculoEncontrado!.horaEntrada) }}</span>
          </div>
          
          <div class="result-row">
            <span class="result-label">â±ï¸ Tiempo Estacionado:</span>
            <span class="result-value">{{ calcularTiempoActual(vehiculoEncontrado!.horaEntrada) }}</span>
          </div>
          
          <div class="result-row">
            <span class="result-label">ğŸ“Š Estado:</span>
            <span class="badge-activo">DENTRO DEL ESTACIONAMIENTO</span>
          </div>
        </div>
      </div>
    </div>

    <!-- VEHÃCULO NO ENCONTRADO -->
    <div *ngIf="busquedaRealizada && !vehiculoEncontrado" class="result-section">
      <div class="result-card warning">
        <div class="result-header">
          <span class="result-icon">âš ï¸</span>
          <h3>VehÃ­culo No Encontrado</h3>
        </div>
        
        <div class="result-body">
          <p class="not-found-message">
            No se encontrÃ³ ningÃºn vehÃ­culo con la placa <strong>{{ placaBuscada }}</strong> dentro del estacionamiento.
          </p>
          <p class="not-found-help">
            â€¢ Verifica que la placa estÃ© escrita correctamente<br>
            â€¢ El vehÃ­culo podrÃ­a no estar registrado<br>
            â€¢ El vehÃ­culo podrÃ­a haber salido del estacionamiento
          </p>
        </div>
      </div>
    </div>

    <!-- HISTORIAL DE BÃšSQUEDAS RECIENTES -->
    <div *ngIf="historialBusquedas.length > 0" class="history-section">
      <h3>ğŸ“‹ BÃºsquedas Recientes</h3>
      <div class="history-list">
        <div 
          *ngFor="let busqueda of historialBusquedas" 
          class="history-item"
          (click)="buscarDesdeHistorial(busqueda.placa)">
          <span class="history-placa">{{ busqueda.placa }}</span>
          <span class="history-time">{{ busqueda.fecha }}</span>
        </div>
      </div>
    </div>

  </ng-container>
</main>

<!-- FOOTER COMPARTIDO -->
<app-footer></app-footer>